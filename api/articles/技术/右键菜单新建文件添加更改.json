{"title":"右键菜单新建文件添加更改","slug":"技术/右键菜单新建文件添加更改","date":"2020-12-22T12:54:56.946Z","updated":"2020-12-23T03:38:03.378Z","comments":true,"path":"api/articles/技术/右键菜单新建文件添加更改.json","excerpt":null,"covers":["/Iamluoluo.github.io/2020/12/22/%E6%8A%80%E6%9C%AF/%E5%8F%B3%E9%94%AE%E8%8F%9C%E5%8D%95%E6%96%B0%E5%BB%BA%E6%96%87%E4%BB%B6%E6%B7%BB%E5%8A%A0%E6%9B%B4%E6%94%B9/image-20201222221900022.png","/Iamluoluo.github.io/2020/12/22/%E6%8A%80%E6%9C%AF/%E5%8F%B3%E9%94%AE%E8%8F%9C%E5%8D%95%E6%96%B0%E5%BB%BA%E6%96%87%E4%BB%B6%E6%B7%BB%E5%8A%A0%E6%9B%B4%E6%94%B9/image-20201222223344275.png","/Iamluoluo.github.io/2020/12/22/%E6%8A%80%E6%9C%AF/%E5%8F%B3%E9%94%AE%E8%8F%9C%E5%8D%95%E6%96%B0%E5%BB%BA%E6%96%87%E4%BB%B6%E6%B7%BB%E5%8A%A0%E6%9B%B4%E6%94%B9/image-20201222223203009.png","/Iamluoluo.github.io/2020/12/22/%E6%8A%80%E6%9C%AF/%E5%8F%B3%E9%94%AE%E8%8F%9C%E5%8D%95%E6%96%B0%E5%BB%BA%E6%96%87%E4%BB%B6%E6%B7%BB%E5%8A%A0%E6%9B%B4%E6%94%B9/image-20201222224218237.png","/Iamluoluo.github.io/2020/12/22/%E6%8A%80%E6%9C%AF/%E5%8F%B3%E9%94%AE%E8%8F%9C%E5%8D%95%E6%96%B0%E5%BB%BA%E6%96%87%E4%BB%B6%E6%B7%BB%E5%8A%A0%E6%9B%B4%E6%94%B9/176987-2f6555b97aac863b.png"],"content":"<h2 id=\"右键菜单新建文件添加更改\"><a href=\"#右键菜单新建文件添加更改\" class=\"headerlink\" title=\"右键菜单新建文件添加更改\"></a>右键菜单新建文件添加更改</h2><blockquote>\n<p>晚上打算写文章时，发现右键菜单里面没有新建md文件的快捷操作。就想着添加右键新建md文件。在网上查找了一下，前面几个方法，都只是说明了如何操作。并没有讲原理。知其然不知其所以然，往往出现了错误，但却不知道怎么该。查询一番后，大致明白了一些原理。记录下来，希望帮助到其他人。</p>\n</blockquote>\n<h4 id=\"原理\"><a href=\"#原理\" class=\"headerlink\" title=\"原理:\"></a>原理:</h4><p>右键菜单的修改本质上是修改注册表。</p>\n<h4 id=\"方法：\"><a href=\"#方法：\" class=\"headerlink\" title=\"方法：\"></a>方法：</h4><p>修改注册表的方法有两种：</p>\n<ul>\n<li>win+R打开运行，输入regedit。进入注册表编辑器修改。</li>\n<li>运行后缀为.reg的文件</li>\n</ul>\n<h4 id=\"具体方法及道理：\"><a href=\"#具体方法及道理：\" class=\"headerlink\" title=\"具体方法及道理：\"></a>具体方法及道理：</h4><pre><code>Windows Registry Editor Version 5.00\n[HKEY_CLASSES_ROOT\\.md]\n@=&quot;Typora.exe&quot;\n[HKEY_CLASSES_ROOT\\.md\\ShellNew]\n&quot;NullFile&quot;=&quot;&quot;\n[HKEY_CLASSES_ROOT\\Typora.exe]\n@=&quot;Markdown&quot;</code></pre>\n<p><code>@=&quot;Typora.exe&quot;</code> 代表的是指定.md文件的运行程序<br><code>@=&quot;Markdown&quot;</code> 代表的是右键时默认的文件名字，这样写新建为<code>新建Markdown.md</code>文件，而且右键菜单中显示 <code>MarkDown</code></p>\n<h6 id=\"解释一下两种方式的对应关系\"><a href=\"#解释一下两种方式的对应关系\" class=\"headerlink\" title=\"解释一下两种方式的对应关系:\"></a>解释一下两种方式的对应关系:</h6><p><code>[HKEY_CLASSES_ROOT.md] </code> 是路径</p>\n<p>这里<code>@=\"Typora.exe\"  </code>相当于修改<code>[HKEY_CLASSES_ROOT.md] </code>中项的值</p>\n<img src=\"/Iamluoluo.github.io/2020/12/22/%E6%8A%80%E6%9C%AF/%E5%8F%B3%E9%94%AE%E8%8F%9C%E5%8D%95%E6%96%B0%E5%BB%BA%E6%96%87%E4%BB%B6%E6%B7%BB%E5%8A%A0%E6%9B%B4%E6%94%B9/image-20201222221900022.png\" class title=\"image-20201222221900022\">\n\n\n\n\n\n<p><code>@=ShellNew</code>这个子项。所有有<code>ShellNew</code>子项的扩展名都会出现在【右键-&gt;新建】菜单中。</p>\n<h6 id=\"ShellNew各项值得意义：\"><a href=\"#ShellNew各项值得意义：\" class=\"headerlink\" title=\"ShellNew各项值得意义：\"></a><code>ShellNew</code>各项值得意义：</h6><ul>\n<li><code>&quot;NullFile&quot;=&quot;&quot;</code>   空文件</li>\n<li><code>FileName </code>新建文件的模版文件</li>\n<li> <code>ItemName </code> 可以修改编码方式（<a href=\"https://www.jianshu.com/p/e956eaae8828%EF%BC%89\">https://www.jianshu.com/p/e956eaae8828）</a></li>\n</ul>\n<h6 id=\"修改菜单排序\"><a href=\"#修改菜单排序\" class=\"headerlink\" title=\"修改菜单排序:\"></a>修改菜单排序:</h6><p>修改后得右键菜单项会显示在：</p>\n<p><code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Discardable\\PostSetup\\ShellNew\\Classes</code></p>\n<p>所以，在这里可以修改右键新建文件菜单的排序</p>\n<p>新建文件的命名是由打开方式的值决定的，比如</p>\n<pre><code class=\"Windows\">[HKEY_CLASSES_ROOT\\.md]\n@=&quot;Typora.md&quot;```</code></pre>\n<p>如果是这么打开方式是这个，则在` Typora.md中修改值，就可以修改新建文件的默认名称。如下图，我的值是洛洛，新建文件名字便是 “新建洛洛.md”。 <img src=\"/Iamluoluo.github.io/2020/12/22/%E6%8A%80%E6%9C%AF/%E5%8F%B3%E9%94%AE%E8%8F%9C%E5%8D%95%E6%96%B0%E5%BB%BA%E6%96%87%E4%BB%B6%E6%B7%BB%E5%8A%A0%E6%9B%B4%E6%94%B9/image-20201222223344275.png\" class title=\"image-20201222223344275\"></p>\n<img src=\"/Iamluoluo.github.io/2020/12/22/%E6%8A%80%E6%9C%AF/%E5%8F%B3%E9%94%AE%E8%8F%9C%E5%8D%95%E6%96%B0%E5%BB%BA%E6%96%87%E4%BB%B6%E6%B7%BB%E5%8A%A0%E6%9B%B4%E6%94%B9/image-20201222223203009.png\" class title=\"image-20201222223203009\">\n\n\n\n\n\n\n\n\n\n<h6 id=\"其他一些项：\"><a href=\"#其他一些项：\" class=\"headerlink\" title=\"其他一些项：\"></a>其他一些项：</h6><p>Content Type和PerceivedType百度了一下，大概就是判断文件类型。</p>\n<pre><code class=\"reg\">Windows Registry Editor Version 5.00 \n\n[HKEY_CLASSES_ROOT\\.md] \n@=&quot;Typora.md&quot; \n&quot;Content Type&quot;=&quot;text/markdown&quot; \n&quot;PerceivedType&quot;=&quot;text&quot; \n[HKEY_CLASSES_ROOT\\.md\\ShellNew] \n&quot;NullFile&quot;=&quot;&quot;</code></pre>\n<h4 id=\"附上修改txt默认编码的方式：\"><a href=\"#附上修改txt默认编码的方式：\" class=\"headerlink\" title=\"附上修改txt默认编码的方式：\"></a>附上修改txt<a href=\"https://www.jianshu.com/p/e956eaae8828\">默认编码的方式</a>：</h4><blockquote>\n<p>将 .txt  ShellNew子项修改：</p>\n<img src=\"/Iamluoluo.github.io/2020/12/22/%E6%8A%80%E6%9C%AF/%E5%8F%B3%E9%94%AE%E8%8F%9C%E5%8D%95%E6%96%B0%E5%BB%BA%E6%96%87%E4%BB%B6%E6%B7%BB%E5%8A%A0%E6%9B%B4%E6%94%B9/image-20201222224218237.png\" class title=\"image-20201222224218237\">\n\n<img src=\"/Iamluoluo.github.io/2020/12/22/%E6%8A%80%E6%9C%AF/%E5%8F%B3%E9%94%AE%E8%8F%9C%E5%8D%95%E6%96%B0%E5%BB%BA%E6%96%87%E4%BB%B6%E6%B7%BB%E5%8A%A0%E6%9B%B4%E6%94%B9/176987-2f6555b97aac863b.png\" class title=\"img\">\n\n\n</blockquote>\n<h4 id=\"其他知识：\"><a href=\"#其他知识：\" class=\"headerlink\" title=\"其他知识：\"></a>其他知识：</h4><p>使用“—”可以配置文件</p>\n<hr>\n<hr>\n<p>  typora-copy-images-to:media   将图片复制到同目录下media目录中</p>\n<hr>\n<hr>\n<h4 id=\"参考链接：\"><a href=\"#参考链接：\" class=\"headerlink\" title=\"参考链接：\"></a>参考链接：</h4><p><a href=\"https://stepneverstop.github.io/win-rightclick-create-md.html%EF%BC%88work%EF%BC%89\">https://stepneverstop.github.io/win-rightclick-create-md.html（work）</a></p>\n<p><a href=\"https://ipdtech8.wordpress.com/2020/04/07/how-to-add-markdown-in-windows/%EF%BC%88work%EF%BC%89\">https://ipdtech8.wordpress.com/2020/04/07/how-to-add-markdown-in-windows/（work）</a></p>\n<p><a href=\"https://wenku.baidu.com/view/dd99a381ec3a87c24028c49c.html%EF%BC%88%E8%B0%83%E7%94%A8notepad%E6%9C%AA%E6%B5%8B%E8%AF%95%EF%BC%89\">https://wenku.baidu.com/view/dd99a381ec3a87c24028c49c.html（调用notepad未测试）</a></p>\n<p><a href=\"https://blog.csdn.net/qq_33873723/article/details/70212265\">https://blog.csdn.net/qq_33873723/article/details/70212265</a></p>\n<p><a href=\"https://www.jianshu.com/p/e956eaae8828\">https://www.jianshu.com/p/e956eaae8828</a></p>\n","more":"<h2 id=\"右键菜单新建文件添加更改\"><a href=\"#右键菜单新建文件添加更改\" class=\"headerlink\" title=\"右键菜单新建文件添加更改\"></a>右键菜单新建文件添加更改</h2><blockquote>\n<p>晚上打算写文章时，发现右键菜单里面没有新建md文件的快捷操作。就想着添加右键新建md文件。在网上查找了一下，前面几个方法，都只是说明了如何操作。并没有讲原理。知其然不知其所以然，往往出现了错误，但却不知道怎么该。查询一番后，大致明白了一些原理。记录下来，希望帮助到其他人。</p>\n</blockquote>\n<h4 id=\"原理\"><a href=\"#原理\" class=\"headerlink\" title=\"原理:\"></a>原理:</h4><p>右键菜单的修改本质上是修改注册表。</p>\n<h4 id=\"方法：\"><a href=\"#方法：\" class=\"headerlink\" title=\"方法：\"></a>方法：</h4><p>修改注册表的方法有两种：</p>\n<ul>\n<li>win+R打开运行，输入regedit。进入注册表编辑器修改。</li>\n<li>运行后缀为.reg的文件</li>\n</ul>\n<h4 id=\"具体方法及道理：\"><a href=\"#具体方法及道理：\" class=\"headerlink\" title=\"具体方法及道理：\"></a>具体方法及道理：</h4><pre><code>Windows Registry Editor Version 5.00\n[HKEY_CLASSES_ROOT\\.md]\n@=&quot;Typora.exe&quot;\n[HKEY_CLASSES_ROOT\\.md\\ShellNew]\n&quot;NullFile&quot;=&quot;&quot;\n[HKEY_CLASSES_ROOT\\Typora.exe]\n@=&quot;Markdown&quot;</code></pre>\n<p><code>@=&quot;Typora.exe&quot;</code> 代表的是指定.md文件的运行程序<br><code>@=&quot;Markdown&quot;</code> 代表的是右键时默认的文件名字，这样写新建为<code>新建Markdown.md</code>文件，而且右键菜单中显示 <code>MarkDown</code></p>\n<h6 id=\"解释一下两种方式的对应关系\"><a href=\"#解释一下两种方式的对应关系\" class=\"headerlink\" title=\"解释一下两种方式的对应关系:\"></a>解释一下两种方式的对应关系:</h6><p><code>[HKEY_CLASSES_ROOT.md] </code> 是路径</p>\n<p>这里<code>@=\"Typora.exe\"  </code>相当于修改<code>[HKEY_CLASSES_ROOT.md] </code>中项的值</p>\n<img src=\"/Iamluoluo.github.io/2020/12/22/%E6%8A%80%E6%9C%AF/%E5%8F%B3%E9%94%AE%E8%8F%9C%E5%8D%95%E6%96%B0%E5%BB%BA%E6%96%87%E4%BB%B6%E6%B7%BB%E5%8A%A0%E6%9B%B4%E6%94%B9/image-20201222221900022.png\" class title=\"image-20201222221900022\">\n\n\n\n\n\n<p><code>@=ShellNew</code>这个子项。所有有<code>ShellNew</code>子项的扩展名都会出现在【右键-&gt;新建】菜单中。</p>\n<h6 id=\"ShellNew各项值得意义：\"><a href=\"#ShellNew各项值得意义：\" class=\"headerlink\" title=\"ShellNew各项值得意义：\"></a><code>ShellNew</code>各项值得意义：</h6><ul>\n<li><code>&quot;NullFile&quot;=&quot;&quot;</code>   空文件</li>\n<li><code>FileName </code>新建文件的模版文件</li>\n<li> <code>ItemName </code> 可以修改编码方式（<a href=\"https://www.jianshu.com/p/e956eaae8828%EF%BC%89\">https://www.jianshu.com/p/e956eaae8828）</a></li>\n</ul>\n<h6 id=\"修改菜单排序\"><a href=\"#修改菜单排序\" class=\"headerlink\" title=\"修改菜单排序:\"></a>修改菜单排序:</h6><p>修改后得右键菜单项会显示在：</p>\n<p><code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Discardable\\PostSetup\\ShellNew\\Classes</code></p>\n<p>所以，在这里可以修改右键新建文件菜单的排序</p>\n<p>新建文件的命名是由打开方式的值决定的，比如</p>\n<pre><code class=\"Windows\">[HKEY_CLASSES_ROOT\\.md]\n@=&quot;Typora.md&quot;```</code></pre>\n<p>如果是这么打开方式是这个，则在` Typora.md中修改值，就可以修改新建文件的默认名称。如下图，我的值是洛洛，新建文件名字便是 “新建洛洛.md”。 <img src=\"/Iamluoluo.github.io/2020/12/22/%E6%8A%80%E6%9C%AF/%E5%8F%B3%E9%94%AE%E8%8F%9C%E5%8D%95%E6%96%B0%E5%BB%BA%E6%96%87%E4%BB%B6%E6%B7%BB%E5%8A%A0%E6%9B%B4%E6%94%B9/image-20201222223344275.png\" class title=\"image-20201222223344275\"></p>\n<img src=\"/Iamluoluo.github.io/2020/12/22/%E6%8A%80%E6%9C%AF/%E5%8F%B3%E9%94%AE%E8%8F%9C%E5%8D%95%E6%96%B0%E5%BB%BA%E6%96%87%E4%BB%B6%E6%B7%BB%E5%8A%A0%E6%9B%B4%E6%94%B9/image-20201222223203009.png\" class title=\"image-20201222223203009\">\n\n\n\n\n\n\n\n\n\n<h6 id=\"其他一些项：\"><a href=\"#其他一些项：\" class=\"headerlink\" title=\"其他一些项：\"></a>其他一些项：</h6><p>Content Type和PerceivedType百度了一下，大概就是判断文件类型。</p>\n<pre><code class=\"reg\">Windows Registry Editor Version 5.00 \n\n[HKEY_CLASSES_ROOT\\.md] \n@=&quot;Typora.md&quot; \n&quot;Content Type&quot;=&quot;text/markdown&quot; \n&quot;PerceivedType&quot;=&quot;text&quot; \n[HKEY_CLASSES_ROOT\\.md\\ShellNew] \n&quot;NullFile&quot;=&quot;&quot;</code></pre>\n<h4 id=\"附上修改txt默认编码的方式：\"><a href=\"#附上修改txt默认编码的方式：\" class=\"headerlink\" title=\"附上修改txt默认编码的方式：\"></a>附上修改txt<a href=\"https://www.jianshu.com/p/e956eaae8828\">默认编码的方式</a>：</h4><blockquote>\n<p>将 .txt  ShellNew子项修改：</p>\n<img src=\"/Iamluoluo.github.io/2020/12/22/%E6%8A%80%E6%9C%AF/%E5%8F%B3%E9%94%AE%E8%8F%9C%E5%8D%95%E6%96%B0%E5%BB%BA%E6%96%87%E4%BB%B6%E6%B7%BB%E5%8A%A0%E6%9B%B4%E6%94%B9/image-20201222224218237.png\" class title=\"image-20201222224218237\">\n\n<img src=\"/Iamluoluo.github.io/2020/12/22/%E6%8A%80%E6%9C%AF/%E5%8F%B3%E9%94%AE%E8%8F%9C%E5%8D%95%E6%96%B0%E5%BB%BA%E6%96%87%E4%BB%B6%E6%B7%BB%E5%8A%A0%E6%9B%B4%E6%94%B9/176987-2f6555b97aac863b.png\" class title=\"img\">\n\n\n</blockquote>\n<h4 id=\"其他知识：\"><a href=\"#其他知识：\" class=\"headerlink\" title=\"其他知识：\"></a>其他知识：</h4><p>使用“—”可以配置文件</p>\n<hr>\n<hr>\n<p>  typora-copy-images-to:media   将图片复制到同目录下media目录中</p>\n<hr>\n<hr>\n<h4 id=\"参考链接：\"><a href=\"#参考链接：\" class=\"headerlink\" title=\"参考链接：\"></a>参考链接：</h4><p><a href=\"https://stepneverstop.github.io/win-rightclick-create-md.html%EF%BC%88work%EF%BC%89\">https://stepneverstop.github.io/win-rightclick-create-md.html（work）</a></p>\n<p><a href=\"https://ipdtech8.wordpress.com/2020/04/07/how-to-add-markdown-in-windows/%EF%BC%88work%EF%BC%89\">https://ipdtech8.wordpress.com/2020/04/07/how-to-add-markdown-in-windows/（work）</a></p>\n<p><a href=\"https://wenku.baidu.com/view/dd99a381ec3a87c24028c49c.html%EF%BC%88%E8%B0%83%E7%94%A8notepad%E6%9C%AA%E6%B5%8B%E8%AF%95%EF%BC%89\">https://wenku.baidu.com/view/dd99a381ec3a87c24028c49c.html（调用notepad未测试）</a></p>\n<p><a href=\"https://blog.csdn.net/qq_33873723/article/details/70212265\">https://blog.csdn.net/qq_33873723/article/details/70212265</a></p>\n<p><a href=\"https://www.jianshu.com/p/e956eaae8828\">https://www.jianshu.com/p/e956eaae8828</a></p>\n","categories":[],"tags":[{"name":"计算机","path":"api/tags/计算机.json"},{"name":"注册表","path":"api/tags/注册表.json"}]}